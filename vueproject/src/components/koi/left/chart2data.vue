<template>
      <div>
        <div>
          <!-- <span class="colorDeepskyblue" style="position: absolute; left: 10px;font-size: 10px;">æ—¶é—´ï¼š2022/07/01-2022/07/31</span>           -->
          <div class="colorGrass font-bold" :style="{'font-size': kFOne + 'px'}">ðŸŒˆä¸­å›½æœ€å€¼å¾—åŽ»çš„æ—…æ¸¸æ™¯ç‚¹</div>
        </div>
      <div>
        <dv-capsule-chart :config="config" :style="{ width: kWOne + 'px',height: kHOne + 'px'}" />
      </div>
    </div>
</template>

<script>
// import { listAVPowerData } from "../../../api/home/index";
export default { 
  data() {
    return {
    // èŽ·å–æµè§ˆå™¨å¯è§†åŒºåŸŸé«˜åº¦ï¼ˆåŒ…å«æ»šåŠ¨æ¡ï¼‰ã€ window.innerHeight
    // èŽ·å–æµè§ˆå™¨å¯è§†åŒºåŸŸé«˜åº¦ï¼ˆä¸åŒ…å«å·¥å…·æ é«˜åº¦ï¼‰ã€document.documentElement.clientHeight
    // èŽ·å–bodyçš„å®žé™…é«˜åº¦  (ä¸‰ä¸ªéƒ½æ˜¯ç›¸åŒï¼Œå…¼å®¹æ€§ä¸åŒçš„æµè§ˆå™¨è€Œè®¾ç½®çš„) document.body.clientHeight
    screenHeight: window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight,
    screenWidth: window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth,
    chartInstance: null,
    allData: {
      aList: [
        {
          name: "å¸ƒè¾¾æ‹‰å®«",
          value: 975
        },
        {
          name: "ä¸½æ±Ÿå¤åŸŽ",
          value: 865
        },
        {
          name: "ä¸‰å³¡å¤§å",
          value: 755
        },
        {
          name: "ä¸‡é‡Œé•¿åŸŽ",
          value: 651
        },
        {
          name: "é’æµ·æ¹–",
          value: 548
        },
        {
          name: "æ³°å±±",
          value: 435
        },
        {
          name: "è¥¿åŒç‰ˆçº³",
          value: 325
        },
        {
          name: "èŽ«é«˜çªŸ",
          value: 218
        },
        {
          name: "ä¸‰äºš",
          value: 115
        },
        {
          name: "ä¹Œé•‡",
          value: 91
        }                                        
      ],
      bList: [
        {
          name: "ä¹å¯¨æ²Ÿ",
          value: 895
        },
        {
          name: "å…µé©¬ä¿‘",
          value: 885
        },
        {
          name: "äº”å¤§è¿žæ± ",
          value: 774
        },
        {
          name: "ä¸‰æ˜Ÿå †é—å€",
          value: 769
        },
        {
          name: "å‡¤å‡°å¤åŸŽ",
          value: 659
        },
        {
          name: "å—äº¬å¤«å­åº™",
          value: 648
        },
        {
          name: "å¯å¯è¥¿é‡Œ",
          value: 534
        },
        {
          name: "å‘¼ä¼¦è´å°”è‰åŽŸ",
          value: 527
        },
        {
          name: "æ–°ç–†å–€çº³æ–¯",
          value: 317
        },
        {
          name: "ç¨»åŸŽäºšä¸",
          value: 301
        }
      ],
      cList: [
        {
          name: "å¤§ç†æ´±æµ·",
          value: 799
        },
        {
          name: "ä¸Šæµ·å¤–æ»©",
          value: 788
        },
        {
          name: "æ³¸æ²½æ¹–",
          value: 677
        },
        {
          name: "ç ç©†æœ—çŽ›å³°",
          value: 666
        },
        {
          name: "å°‘æž—å¯º",
          value: 555
        },
        {
          name: "å³¨çœ‰å±±",
          value: 544
        },
        {
          name: "é¦™æ ¼é‡Œæ‹‰",
          value: 433
        },
        {
          name: "æ‰¿å¾·é¿æš‘å±±åº„",
          value: 422
        },
        {
          name: "æ•…å®«",
          value: 311
        },
        {
          name: "å°æ¹¾æ—¥æœˆæ½­",
          value: 300
        }
      ],
      dList: [
        {
          name: "å¼ å®¶ç•Œ",
          value: 697
        },
        {
          name: "æ’å±±",
          value: 687
        },
        {
          name: "é¦™æ ¼é‡Œæ‹‰",
          value: 579
        },
        {
          name: "é¿æš‘å±±åº„",
          value: 563
        },
        {
          name: "æ•…å®«",
          value: 457
        },
        {
          name: "é»„æžœæ ‘ç€‘å¸ƒ",
          value: 442
        },
        {
          name: "é»„å±±",
          value: 336
        },
        {
          name: "å°æ¹¾æ—¥æœˆæ½­",
          value: 325
        },
        {
          name: "é’æµ·æ¹–",
          value: 211
        },
        {
          name: "æ™®é™€å±±",
          value: 200
        }
      ],
      eList: [
        {
          name: "é•¿ç™½å±±å¤©æ± ",
          value: 595
        },
        {
          name: "ä¹å±±å¤§ä½›",
          value: 587
        },
        {
          name: "çŽ‹è€…å³¡è°·",
          value: 376
        },
        {
          name: "å’Œå¹³è‰ä¸›",
          value: 362
        },
        {
          name: "QQé£žè½¦èµ›é“",
          value: 653
        },
        {
          name: "æ¤ç‰©VSåƒµå°¸",
          value: 649
        },
        {
          name: "æ–—ç½—å¤§é™†",
          value: 737
        },
        {
          name: "OverLoad",
          value: 723
        },
        {
          name: "èŸ¹é»„å ¡",
          value: 616
        },
        {
          name: "é’é’è‰åŽŸ",
          value: 403
        }
      ]
    },
    // é«˜åº¦
    kHOne: null,
    // å®½åº¦
    kWOne: null,
    // æ ‡é¢˜å­—ä½“
    kFOne: null,
    // å®šæ—¶å™¨ç›‘æŽ§
    koiTime: null,
    // å±€éƒ¨åˆ·æ–°å®šæ—¶å™¨ 
    koiTimer: null,
    // ç¿»é¡µå®šæ—¶å™¨
    timerId: null,    
    config: {
      showValue: true,
      data: []
    }
   }
 },
  beforeMount(){
    this.kWOne = Math.round(this.screenWidth * 0.23)
    this.kHOne = Math.round(this.screenHeight * 0.42)
    this.kFOne = Math.round(this.screenWidth / 120)
  },  
  mounted(){
    // é¡µé¢å¤§å°æ”¹å˜æ—¶è§¦å‘
    window.addEventListener('resize',this.getScreenHeight, false);
    // é¡µé¢å¤§å°æ”¹å˜æ—¶è§¦å‘
    window.addEventListener('resize',this.getScreenWidth, false);
    // é¼ æ ‡ç§»åŠ¨æ—¶è§¦å‘
    //window.addEventListener('mousemove',this.getHeight, false);
    this.resizeScreen();
    // èŽ·å–åŽç«¯æŽ¥å£æ•°æ®
    // this.getCurrentData();
    // æ•°æ®åˆ†ç»„
    this.getData();
    // æ‰§è¡Œå±€éƒ¨æ•°æ®åˆ·æ–°å®šæ—¶å™¨
    // this.getDataTimer();
    // æ•°æ®åˆ‡æ¢å®šæ—¶å™¨
    this.handleTimer();
  },
  destroyed() {
    // æ¸…é™¤è‡ªé€‚åº”å®šæ—¶å™¨
    clearInterval(this.koiTime);
    this.koiTime = null;
    // æ¸…é™¤å±€éƒ¨åˆ·æ–°å®šæ—¶å™¨
    clearInterval(this.koiTimer);
    this.koiTimer = null; 
    // æ¸…é™¤å±€éƒ¨åˆ·æ–°å®šæ—¶å™¨
    clearInterval(this.timerId);
    this.timerId = null;     
    // é¡µé¢å¤§å°æ”¹å˜æ—¶è§¦å‘é”€æ¯
    window.removeEventListener('resize',this.getScreenHeight, false);
    // é¡µé¢å¤§å°æ”¹å˜æ—¶è§¦å‘é”€æ¯
    window.removeEventListener('resize',this.getScreenWidth, false);
  }, 
  methods: {
    resizeScreen(){
      this.koiTime = setInterval(() => {
        this.getScreenHeight();
        this.getScreenWidth();
      }, 200)
    },
    // èŽ·å–æµè§ˆå™¨é«˜åº¦è¿›è¡Œè‡ªé€‚åº”
    getScreenHeight() {
        this.screenHeight = window.innerHeight || document.documentElement.innerHeight || document.body.clientHeight;
        // å››èˆäº”å…¥å–æ•´æ•°
        this.kHOne = Math.round(this.screenHeight * 0.42);
        //console.log("é«˜åº¦->"+this.screenHeight +"-"+ this.kHOne);
    },
    // å­—ä½“å¤§å°æ ¹æ®å®½åº¦è‡ªé€‚åº”
    getScreenWidth(){
      this.screenWidth = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
      this.kWOne = Math.round(this.screenWidth * 0.23);
      this.kFOne = Math.round(this.screenWidth / 120);
      //console.log("å®½åº¦->"+this.screenWidth);
    },
    getCurrentData(){
        // æ‰§è¡Œåˆ·æ–°æ•°æ®çš„æ–¹æ³•
        listAVPowerData().then(res => {
          this.allData = res.data;
        })
    },
    getData(value,unit) {
        //console.log("ALLDATA->",JSON.stringify(res.data)) 
        const { config } = this;
        // å°†æ•°æ®èµ‹å€¼ç»™DataVçš„èƒ¶å›ŠæŸ±å›¾
        if(value == null){
           this.config.data = this.allData.aList;
           this.config.unit = "æ¬¡";
        } else {
          this.config.data = value;
          this.config.unit = unit;
        } 
        
        this.config = { ...this.config }
      // èŽ·å–æœåŠ¡å™¨çš„æ•°æ®, å¯¹this.allDataè¿›è¡Œèµ‹å€¼ä¹‹åŽ, è°ƒç”¨updateChartæ–¹æ³•æ›´æ–°å›¾è¡¨
      //console.log("ALLDATA->",JSON.stringify(res.data))
      //console.log("ALLDATA->",JSON.stringify(this.allData))
    }, 
    // æ•°æ®åˆ·æ–°å®šæ—¶å™¨
    getDataTimer(){
      this.koiTimer = setInterval(() => {    
        // æ‰§è¡Œåˆ·æ–°æ•°æ®çš„æ–¹æ³•
        // listAVPowerData().then(res => {
        //   this.allData = res.data;
        // })
        // console.log("Hello World")
      }, 60000)
    },
    // æ•°æ®åˆ‡æ¢å®šæ—¶å™¨
    handleTimer(){
      let index = 1;
      this.koiTimer = setInterval(() => {   
        index ++;
        if(index == 1){
          this.getData(this.allData.aList,"æ¬¡");
        }else if(index == 2){
          this.getData(this.allData.bList,"åˆ€");
        }else if(index == 3){
          this.getData(this.allData.cList,"ä¸¤");
        }else if(index == 4){
          this.getData(this.allData.dList,"ç±³");
        }else if(index == 5){
          this.getData(this.allData.eList,"æ–¤");
        }else if(index > 5){
          index = 1;  
          this.getData(this.allData.aList);
        }    
      }, 2000)      
    }          
  },
}
</script>

<style lang="less" scoped>

</style>
